{% extends 'base.html' %}
{% block content %}


<div class="dropdown">
    <button type="button" class="btn dropdown-toggle" data-toggle="dropdown">
      Incomes
    </button>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="{% url 'transactions' %}" style="color:#8503ef">Transactions</a>
      <a class="dropdown-item" href="{% url 'incomes' %}" style="color:#03EF62 ;">Incomes</a>
      <a class="dropdown-item" href="{% url 'expenses' %}" style="color: #FF931E">Expenses</a>
    </div>
  </div>
<br>
<a class="new-btn" href="{% url 'income_create' %}">+ New Income </a>
<br><br>

<div class="container mt-4">
    <div class="card">
        <div class="card-body">
            <table id="income-table" class="table">
                <thead>
                    <tr>
                        <th>Amount</th>
                        <th>Category</th>
                        <th class="date">Date <span class="sort-arrow">&#x25B2;</span></th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for income in incomes %}
                    <tr>
                        <td>{{ income.amount }}</td>
                        <td>{{ income.category }}</td>
                        <td>{{ income.date|date:"d/m/Y" }}</td>
                        <td>
                            <a href="{% url 'income_update' income.id %}" ><i class="uil uil-edit"></i></a>
                             &nbsp; &nbsp;
                            <a href="{% url 'income_delete' income.id %}" ><i class="uil uil-trash-alt"></i></a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    $(document).ready(function() {
        let ascending = true; // Default sort order

        function sortByDate() {
            let rows = $('#income-table tbody tr').get();
            rows.sort(function(a, b) {
                let dateA = new Date($(a).find('td:eq(2)').text());
                let dateB = new Date($(b).find('td:eq(2)').text());
                if (ascending) {
                    return dateA - dateB;
                } else {
                    return dateB - dateA;
                }
            });
            $.each(rows, function(index, row) {
                $('#income-table').append(row);
            });

            // Toggle arrow icon and sort direction
            $('.sort-arrow').html(ascending ? '&#x25B2;' : '&#x25BC;');
            ascending = !ascending;
        }

        // Add click event listener to the date th
        $('#income-table th.date').on('click', function() {
            sortByDate();
        });
    });
</script>



{% endblock %}