{% extends 'base.html' %}
{% block content %}

<style>

.calc-input-box {
    background-color: #FFFFFF;
    border-style: none;
    border-radius: 1.25vmin;
    height: 3vmin;
    box-shadow: 2px 2px 4px #c3c3c3;
}

#form-icon {
    font-size: 12.5px;
}

.calc-text {
    font-size: 20px;
}

</style>

<h1>Compound Interest Calculator</h1>
<br>


<form>
    <label for="startingAmount" style="padding-right: 6.25vmin;" class="calc-text">Initial Investment <strong><span id="form-icon">(£)</span></strong></label>
    <input type="number" min="0" required id="startingAmount" name="startingAmount" class="calc-input-box"><br>
    <label for="contribution" style="padding-right: 3vmin;" class="calc-text">Yearly Contribution <strong><span id="form-icon">  (£)</span></strong></label>
    <input type="number" required id="contribution" name="contribution" class="calc-input-box"><br>
    <label for="yearlyInterest" style="padding-right: 2.75vmin;" class="calc-text">Yearly Interest Rate <strong><span id="form-icon">(%)</span></strong></label>
    <input type="number" required id="yearlyInterest" name="yearlyInterest" class="calc-input-box"><br>
    <label for="years" style="padding-right: 1vmin;" class="calc-text">Length of Time in Years</label>
    <input type="number" min="1" required id="years" name="years" class="calc-input-box"><br>
    <button class="btn btn-primary" style="margin-top: 3.5vmin;">Calculate</button>
</form>

<hr>
<br>
<h2></h2>
<br>

<div id="table-section">

</div>


<script>
    const button = document.querySelector('button');
    let startingAmount;
    let yearlyInterest;
    let years;

    const format = {
        style: "decimal",
        minimumFractionDigits: 2,
        maximumFractionDigits: 2,
    };

    const table = `
        <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>Year</th>
                <th>Amount</th>
                <th>Contribution</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
        </table>
    `

    function compound(start, contribution, interest, years) {
        let amount = start;
        const percent = (parseInt(interest) + 100) / 100;
        const cont = parseInt(contribution);
        result = [];

        for (let i = 0; i < years; i++) {
            amount = amount * percent;
            amount += cont
            result.push({year: i + 1, amount: amount, contribution: cont})
        }
        return result;
    }

    button.addEventListener('click', function (event) {
        event.preventDefault();
        start = document.getElementById('startingAmount').value;
        contribution = document.getElementById('contribution').value;
        int = document.getElementById('yearlyInterest').value;
        years = document.getElementById('years').value;
        if (start && contribution && int && years) {
            let result = compound(start, contribution, int, years)
            let string = []
            result.forEach(res => {
                string.push(
                    `<tr>
                    <td>${res.year}</td>
                    <td>£${res.amount.toLocaleString("en-US", format)}</td>
                    <td>£${res.contribution.toLocaleString("en-US", format)}</td>
                    </tr>`
                )
                
            })
            document.getElementById('table-section').innerHTML = table;
            document.querySelector('h2').innerText = `In ${years} years, you will have £${result[result.length - 1].amount.toLocaleString("en-US", format)}!`
            document.querySelector('tbody').innerHTML = string.join('');
        }
    })

</script>


{% endblock %}